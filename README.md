# CVE-2023-46604 ActiveMQ漏洞验证工具

### 单目标检测

1. **填写目标信息**

   - 目标主机：ActiveMQ服务器IP或域名
   - ActiveMQ端口：默认61616
   - 本地监听端口：工具自动生成

2. **配置XML URL**

   - 工具自动获取本机IP并更新URL
   - 支持手动修改为特定URL

3. **开始检测**

   - 点击"开始检测"按钮
   - 观察进度条和日志输出
   - 等待检测结果
<img width="1800" height="1300" alt="image" src="https://github.com/user-attachments/assets/268a9d71-fbd6-4b2f-b05e-da059c13e6a8" />


注意: IP和端口会自动添加到XML URL中。如反连为公网,请自行填写公网ip,格式为: http://ip:port/path.

公网环境
<img width="1764" height="1278" alt="image" src="https://github.com/user-attachments/assets/9c3849f5-f888-4452-b32b-1df93dbd86e5" />





### 批量目标检测

1. **导入目标列表**

   - 点击"导入目标列表"按钮
   - 选择包含目标IP的文件（每行一个IP）
   - 工具自动加载并显示预览

2. **开始批量检测**

   - 点击"开始检测"执行批量扫描

   - 实时显示处理进度和成功数量

   - 检测完成后显示汇总报告
<img width="1800" height="1300" alt="image" src="https://github.com/user-attachments/assets/4ccd2570-1660-4728-80e4-d72a8d78462e" />



### 检测结果说明

- **✅ 存在漏洞**: 目标请求了恶意XML文件，确认存在漏洞
- **❌ 不存在漏洞**: 未检测到XML请求，可能不存在漏洞
- **⚠️ 连接失败**: 目标服务不可达或配置错误

## 🗂️ 文件格式

### 目标列表文件格式

txt

```
192.168.1.100
192.168.1.101
192.168.1.102:61617
example.com
```



> 每行一个目标，支持IP、域名，可指定端口（默认61616）

## 🔧 配置说明

### XML URL配置

- **默认模板**: `http://your-ip/poc.xml`
- **自动替换**: 工具运行时会自动将`your-ip`替换为本机IP
- **自定义**: 支持修改为任意有效的HTTP URL

### 网络配置

- **监听地址**: 自动绑定到 `0.0.0.0`（所有网络接口）
- **端口范围**: 使用动态端口（49152-65535）
- **连接超时**: 5秒连接超时设置

## 📋 检测原理

工具基于以下技术原理实现漏洞检测：

1. **OpenWire协议分析** - 解析ActiveMQ通信协议

2. **异常响应构造** - 构造特制的ExceptionResponse消息

3. **Spring上下文注入** - 利用ClassPathXmlApplicationContext加载远程XML

4. **HTTP服务监听** - 启动HTTP服务器等待目标回调

5. **漏洞确认** - 通过HTTP请求确认漏洞存在

   

## ⚠️ 免责声明

**重要提示**: 本工具仅限于安全研究和授权测试使用！

### 使用规范

- ✅ 用于授权的渗透测试
- ✅ 企业安全自查
- ✅ 教育学习研究

### 禁止行为

- ❌ 未授权测试他人系统
- ❌ 用于非法攻击活动
- ❌ 传播恶意代码

**使用者需对自身行为负责，作者不承担任何法律责任！**



## 后续更新

后续更新漏洞利用模块，请关注我们。
